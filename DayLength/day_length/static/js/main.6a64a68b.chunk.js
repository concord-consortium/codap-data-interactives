(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(t,e,n){t.exports=n(23)},20:function(t,e,n){},22:function(t,e,n){},23:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),a=n(10),i=n.n(a),c=(n(20),n(1)),u=n(3),s=n(4),l=n(13),h=n(11),f=n(14),p=n(2),d=n(12),v=null,y="preinit",m={countDiReq:0,countDiRplSuccess:0,countDiRplFail:0,countDiRplTimeout:0,countCodapReq:0,countCodapUnhandledReq:0,countCodapRplSuccess:0,countCodapRplFail:0,timeDiFirstReq:null,timeDiLastReq:null,timeCodapFirstReq:null,timeCodapLastReq:null},g=null,w={},b=[];function L(t,e){return"*"===e||t.startsWith(e)}function x(t,e){var n=t.action,r=t.resource,o=t.values,a={success:!0};y="active",m.countCodapReq+=1,m.timeCodapLastReq=new Date,m.timeCodapFirstReq||(m.timeCodapFirstReq=m.timeCodapLastReq),"notify"!==n||Array.isArray(o)||(o=[o]);var i=!1,c=!0;return"get"===n||"update"===n?(b.some(function(e){var o=!1;try{if(e.actionSpec===n&&L(r,e.resourceSpec)){var i=e.handler(t);i&&i.success?m.countCodapRplSuccess++:m.countCodapRplFail++,a=i,o=!0}}catch(c){o=!0}return o}),i||m.countCodapUnhandledReq++):"notify"===n&&o.forEach(function(t){b.forEach(function(e){if(i=!1,e.actionSpec===n&&L(r,e.resourceSpec)&&(!e.operation||e.operation===t.operation&&e.handler)){var o=e.handler({action:n,resource:r,values:t});o&&o.success?m.countCodapRplSuccess++:m.countCodapRplFail++,c=c&&!!o&&o.success,i=!0}}),i||m.countCodapUnhandledReq++}),e(a)}var E={stats:m,init:function(t,e){var n=this;return new Promise(function(r,o){var a={action:"update",resource:"interactiveFrame",values:{name:t.name,title:t.title,version:t.version,dimensions:t.dimensions,preventBringToFront:t.preventBringToFront,preventDataContextReorg:t.preventDataContextReorg}};return g=t,v=new d.IframePhoneRpcEndpoint(x,"data-interactive",window.parent),g.customInteractiveStateHandler||n.on("get","interactiveState",function(){return{success:!0,values:n.getInteractiveState()}}.bind(n)),n.sendRequest([a,{action:"get",resource:"interactiveFrame"}]).then(function(a){var i=a&&a[1]&&a[1].success,c=i&&a[1].values,u=c&&c.savedState;n.updateInteractiveState(u),i?(t.stateHandler&&t.stateHandler(u),r(u)):o(a?a[1]&&a[1].values&&a[1].values.error||"unknown failure":"Connection request to CODAP timed out."),e&&e(u)},o)}.bind(this))},getConnectionState:function(){return y},getStats:function(){return m},getConfig:function(){return g},getInteractiveState:function(){return w},updateInteractiveState:function(t){t&&(w=Object.assign(w,t))},destroy:function(){v=null},sendRequest:function(t,e){return new Promise(function(n,r){switch(y){case"closed":r("sendRequest on closed CODAP connection: "+JSON.stringify(t));break;case"preinit":default:v&&(m.countDiReq++,m.timeDiLastReq=new Date,m.timeDiFirstReq||(m.timeCodapFirstReq=m.timeDiLastReq),v.call(t,function(o){!function(t,e,o){void 0===e?(r("handleResponse: CODAP request timed out: "+JSON.stringify(t)),m.countDiRplTimeout++):(y="active",e.success?m.countDiRplSuccess++:m.countDiRplFail++,n(e)),o&&o(e,t)}(t,o,e)}))}})},on:function(t,e,n,r){var o,a,i="notify",c=Array.prototype.slice.call(arguments);["get","update","notify"].indexOf(c[0])>=0&&(i=c.shift()),o=c.shift(),"function"!==typeof c[0]&&(a=c.shift());var u={actionSpec:i,resourceSpec:o,operation:a,handler:c.shift()};b.push(u)},parseResourceSelector:function(t){var e=/([A-Za-z0-9_-]+)\[([^\]]+)]/,n={};return t.split(".").forEach(function(t){var r,o,a=e.exec(t);e.test(t)&&a?(r=a[1],o=a[2],n[r]=o,n.type=r):n.type=t}),n}};function O(){O=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new _(r||[]);return o(i,"_invoke",{value:S(t,n,c)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function w(){}var b={};s(b,i,function(){return this});var L=Object.getPrototypeOf,x=L&&L(L(q([])));x&&x!==n&&r.call(x,i)&&(b=x);var E=w.prototype=m.prototype=Object.create(b);function N(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function j(t,e){function n(o,a,i,c){var u=h(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==typeof l&&r.call(l,"__await")?e.resolve(l.__await).then(function(t){n("next",t,i,c)},function(t){n("throw",t,i,c)}):e.resolve(l).then(function(t){s.value=t,i(s)},function(t){return n("throw",t,i,c)})}c(u.arg)}var a;o(this,"_invoke",{value:function(t,r){function o(){return new e(function(e,o){n(t,r,e,o)})}return a=a?a.then(o,o):o()}})}function S(e,n,r){var o=f;return function(a,i){if(o===d)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var u=k(c,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var s=h(e,n,r);if("normal"===s.type){if(o=r.done?v:p,s.arg===y)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=v,r.method="throw",r.arg=s.arg)}}}function k(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var a=h(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function q(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(typeof e+" is not iterable")}return g.prototype=w,o(E,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},N(j.prototype),s(j.prototype,c,function(){return this}),e.AsyncIterator=j,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new j(l(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},N(E),s(E,u,"Generator"),s(E,i,function(){return this}),s(E,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=q,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:q(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function N(t,e,n){return j.apply(this,arguments)}function j(){return(j=Object(c.a)(O().mark(function t(e,n,r){var o;return O().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o={name:e,version:n,dimensions:r},t.next=3,E.init(o);case 3:case"end":return t.stop()}},t)}))).apply(this,arguments)}n(22);var S=n(6);function k(){k=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new _(r||[]);return o(i,"_invoke",{value:j(t,n,c)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function w(){}var b={};s(b,i,function(){return this});var L=Object.getPrototypeOf,x=L&&L(L(q([])));x&&x!==n&&r.call(x,i)&&(b=x);var E=w.prototype=m.prototype=Object.create(b);function O(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function N(t,e){function n(o,a,i,c){var u=h(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==typeof l&&r.call(l,"__await")?e.resolve(l.__await).then(function(t){n("next",t,i,c)},function(t){n("throw",t,i,c)}):e.resolve(l).then(function(t){s.value=t,i(s)},function(t){return n("throw",t,i,c)})}c(u.arg)}var a;o(this,"_invoke",{value:function(t,r){function o(){return new e(function(e,o){n(t,r,e,o)})}return a=a?a.then(o,o):o()}})}function j(e,n,r){var o=f;return function(a,i){if(o===d)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var u=S(c,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var s=h(e,n,r);if("normal"===s.type){if(o=r.done?v:p,s.arg===y)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=v,r.method="throw",r.arg=s.arg)}}}function S(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var a=h(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function q(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(typeof e+" is not iterable")}return g.prototype=w,o(E,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(N.prototype),s(N.prototype,c,function(){return this}),e.AsyncIterator=N,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new N(l(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},O(E),s(E,u,"Generator"),s(E,i,function(){return this}),s(E,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=q,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:q(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}var C=800,R=5,_=3,q="city, state or country",D="geo-name-select",P="geoname-selection-list",T="geoname-selector-option",F="geoname-hidden",G="geoname-candidate",A=function(){function t(e,n,r){Object(u.a)(this,t),this.inputEl=null,this.selectionListEl=null,this.placeList=[],this.queryInProgress=!1,this.timer=null;var o=this;function a(){o.timer=null,o.autoComplete()}function i(t){var e=o.selectionListEl.classList.contains(F),n=o.selectionListEl.querySelector("."+G);if("Enter"===t.key)e?(o.autoComplete(),t.stopPropagation()):n&&(o.inputEl.value=n.innerText,o.selectedPlace=o.placeList[Number(n.attributes.dataix.value)],o.selectionHandler(o.selectedPlace),o.selectionListEl.classList.add(F)),o.inputEl.blur();else if("ArrowDown"===t.key){if(!e){var r=o.selectionListEl.querySelector("."+G),i=r&&r.getAttribute("dataix"),c=null!=i&&Math.min(Number(i)+1,R);if(c&&Number(i)!==c){var u=o.selectionListEl.querySelectorAll(".".concat(T))[c];null==u||u===r||u.classList.contains(F)||(r.classList.remove(G),u.classList.add(G),t.stopPropagation(),t.preventDefault())}}}else if("ArrowUp"===t.key){if(!e){var s=o.selectionListEl.querySelector("."+G),l=s&&s.getAttribute("dataix"),h=null!=l&&Math.max(Number(l)-1,0);if(null!=h&&Number(l)!==h){var f=o.selectionListEl.querySelectorAll(".".concat(T))[h];null==f||f===s||f.classList.contains(F)||(s.classList.remove(G),f.classList.add(G),t.stopPropagation(),t.preventDefault())}}}else{var p=this.value;o.selectedPlace=null,p.length>=_&&(o.timer&&clearTimeout(o.timer),o.timer=setTimeout(a,C))}}this.selectionHandler=r,this.myGeonamesUser=n;var c=document.createElement("input");c.classList.add(D),c.setAttribute("type","text"),c.setAttribute("placeholder",q),c.addEventListener("keydown",i),c.addEventListener("focus",function(){o.inputEl.select()}),this.inputEl=c,e.append(c),(c=document.createElement("div")).classList.add(P),c.classList.add(F),c.addEventListener("mouseover",function(t){var e=t.target;e.classList.contains(T)&&(o.selectionListEl.querySelectorAll("."+G).forEach(function(t){t.classList.remove(G)}),e.classList.add(G),t.stopPropagation())}),c.addEventListener("click",function(t){var e=t.target;e.classList.contains(T)&&(o.inputEl.value=e.innerText,o.selectedPlace=o.placeList[Number(e.attributes.dataix.value)],o.selectionHandler(o.selectedPlace)),this.classList.add(F)}),c.addEventListener("keydown",i),this.selectionListEl=c,e.append(c)}return Object(s.a)(t,[{key:"geoNameSearch",value:function(){var t=Object(c.a)(k().mark(function t(e,n){var r,o,a,i,c,u,s,l,h,f;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r="username=".concat(this.myGeonamesUser),o="maxRows=".concat(n||R),a="featureClass=P",i="lang=en",c="type=json",u="isNameRequired=true",s="name_startsWith=".concat(e),l="".concat("https://secure.geonames.org/search","?").concat([r,o,a,i,c,u,s].join("&")),t.next=10,fetch(l);case 10:if(!(h=t.sent).ok){t.next=17;break}return t.next=14,h.json();case 14:if(!((f=t.sent).totalResultsCount>0)){t.next=17;break}return t.abrupt("return",f.geonames.map(function(t){var e="US"===t.countryCode?t.adminCode1:t.countryName;return{name:"".concat(t.name,", ").concat(e),latitude:t.lat,longitude:t.lng}}));case 17:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"populateGeoNameSelector",value:function(t,e){if(this.placeList&&this.placeList.length){var n,r=t.querySelectorAll("."+T);t.classList.remove(F),r.forEach(function(t){t.classList.add(F)}),e.forEach(function(e,o){r&&r[o]?((n=r[o]).classList.remove(F),n.classList.remove(G)):((n=document.createElement("div")).classList.add(T),t.append(n)),n.innerText=e.name,n.setAttribute("dataix",String(o)),0===o&&n.classList.add(G)})}}},{key:"autoComplete",value:function(){var t=Object(c.a)(k().mark(function t(){var e,n;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.inputEl.value,t.prev=1,this.queryInProgress=!0,t.next=5,this.geoNameSearch(e);case 5:n=t.sent,this.placeList=n||[],this.populateGeoNameSelector(this.selectionListEl,this.placeList);case 8:return t.prev=8,this.queryInProgress=!1,t.finish(8);case 11:case"end":return t.stop()}},t,this,[[1,,8,11]])}));return function(){return t.apply(this,arguments)}}()}]),t}();function I(){I=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new R(r||[]);return o(i,"_invoke",{value:j(t,n,c)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function w(){}var b={};s(b,i,function(){return this});var L=Object.getPrototypeOf,x=L&&L(L(_([])));x&&x!==n&&r.call(x,i)&&(b=x);var E=w.prototype=m.prototype=Object.create(b);function O(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function N(t,e){function n(o,a,i,c){var u=h(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==typeof l&&r.call(l,"__await")?e.resolve(l.__await).then(function(t){n("next",t,i,c)},function(t){n("throw",t,i,c)}):e.resolve(l).then(function(t){s.value=t,i(s)},function(t){return n("throw",t,i,c)})}c(u.arg)}var a;o(this,"_invoke",{value:function(t,r){function o(){return new e(function(e,o){n(t,r,e,o)})}return a=a?a.then(o,o):o()}})}function j(e,n,r){var o=f;return function(a,i){if(o===d)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var u=S(c,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var s=h(e,n,r);if("normal"===s.type){if(o=r.done?v:p,s.arg===y)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=v,r.method="throw",r.arg=s.arg)}}}function S(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var a=h(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function _(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(typeof e+" is not iterable")}return g.prototype=w,o(E,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(N.prototype),s(N.prototype,c,function(){return this}),e.AsyncIterator=N,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new N(l(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},O(E),s(E,u,"Generator"),s(E,i,function(){return this}),s(E,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=_,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;C(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:_(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}var H="Day Length",Y="1.00",U={width:280,height:385},z={contextName:"Sunrise and Sunset by Location",parentCollectionName:"Locations",childCollectionName:"Days"},B=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(l.a)(this,Object(h.a)(e).call(this,t))).ref=void 0,n.state={loc:"",lat:void 0,long:void 0,hasError:!1},n.ref=o.a.createRef(),n.getData=n.getData.bind(Object(p.a)(Object(p.a)(n))),n.handleLocation=n.handleLocation.bind(Object(p.a)(Object(p.a)(n))),n}return Object(f.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){var t=Object(c.a)(I().mark(function t(){return I().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(H,Y,U);case 2:this.ref&&new A(this.ref.current,"codap",this.handleLocation);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidCatch",value:function(t,e){console.log(t,e)}},{key:"handleLocation",value:function(t){this.setState({lat:t.latitude,long:t.longitude,loc:t.name})}},{key:"getData",value:function(){var t=Object(c.a)(I().mark(function t(){var e,n,r,o,a,i,u,s,l,h,f,p,d,v,y,m,g;return I().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(m=function(){var t=60*Math.round(Number(p.state.long)/15),e=new Date(v,0,1),n=6e4*(t+e.getTimezoneOffset()),r=e.getTime();console.log("kHoursToAdd =",n);for(var o=0;o<366;o++){var a=new Date(r+24*o*60*60*1e3);if(a.getFullYear()>v)break;var i=Object(S.getSunrise)(Number(p.state.lat),Number(p.state.long),a),c=Object(S.getSunset)(Number(p.state.lat),Number(p.state.long),a);"Invalid Date"===String(i)||"Invalid Date"===String(c)?(c="",i=""):(c=new Date(c.valueOf()+n),i=new Date(i.valueOf()+n)),d.push({parent:y,values:{day:a,sunrise:i,sunset:c}})}},f=function(){return(f=Object(c.a)(I().mark(function t(e){var n;return I().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=[{name:"day length",formula:"(sunset-sunrise)/3600 > 0 ? (sunset-sunrise)/3600 : (sunset-sunrise)/3600 + 24"},{name:"rise hour",formula:"hours(sunrise)+minutes(sunrise)/60"},{name:"set hour",formula:"hours(sunset)+minutes(sunset)/60"},{name:"state",formula:""}].map(function(t){return{action:"update",resource:"dataContext[".concat(e.contextName,"].collection[").concat(e.childCollectionName,"].attribute[").concat(t.name,"]"),values:{formula:t.formula}}}),t.next=3,E.sendRequest(n);case 3:case"end":return t.stop()}},t)}))).apply(this,arguments)},h=function(t){return f.apply(this,arguments)},l=function(){return(l=Object(c.a)(I().mark(function t(e){var n;return I().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=["day length","rise hour","set hour"].map(function(t){return{action:"update",resource:"dataContext[".concat(e.contextName,"].collection[").concat(e.childCollectionName,"].attribute[").concat(t,"]"),values:{formula:""}}}),t.next=3,E.sendRequest(n);case 3:case"end":return t.stop()}},t)}))).apply(this,arguments)},function(t){return l.apply(this,arguments)},s=function(){return(s=Object(c.a)(I().mark(function t(e){var n;return I().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e){t.next=9;break}return t.next=3,a("caseTable",e);case 3:if(n=t.sent,n>=0){t.next=9;break}return t.next=8,E.sendRequest({action:"create",resource:"component",values:{type:"caseTable",name:e,title:e,dimensions:{width:572,height:200},dataContext:e}}).catch(function(t){console.log(JSON.stringify(t))});case 8:t.sent;case 9:case"end":return t.stop()}},t)}))).apply(this,arguments)},u=function(t){return s.apply(this,arguments)},i=function(){return(i=Object(c.a)(I().mark(function t(e,n,r){var o,a,i;return I().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.sendRequest({action:"get",resource:"componentList"}).catch(function(){console.log("Error getting component list")});case 2:return o=t.sent,a=-1,o.success&&(i=o.values.find(function(t){return t.type===e&&(t.title===n||t.name===r)}))&&(a=i.id),t.abrupt("return",a);case 6:case"end":return t.stop()}},t)}))).apply(this,arguments)},a=function(t,e,n){return i.apply(this,arguments)},o=function(){return(o=Object(c.a)(I().mark(function t(n){return I().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n.contextName);case 2:if(t.sent){t.next=5;break}return t.next=5,E.sendRequest({action:"create",resource:"dataContext",values:{name:n.contextName,title:n.contextName,collections:[{name:n.parentCollectionName,title:n.parentCollectionName,attrs:[{name:"location"},{name:"latitude",type:"categorical",precision:2},{name:"longitude",type:"categorical",precision:2}]},{name:n.childCollectionName,title:n.childCollectionName,parent:n.parentCollectionName,attrs:[{name:"day",type:"date",precision:"day"},{name:"day length",type:"numeric",unit:"hours",precision:3},{name:"sunrise",type:"date",precision:"minute",hidden:!0,description:"Note that time is for the timezone of your browser"},{name:"sunset",type:"date",precision:"minute",hidden:!0,description:"Note that time is for the timezone of your browser"},{name:"rise hour",unit:"decimal hours",description:"Note that time is for the timezone of your browser"},{name:"set hour",unit:"decimal hours",description:"Note that time is for the timezone of your browser"}]}]}});case 5:case"end":return t.stop()}},t)}))).apply(this,arguments)},r=function(t){return o.apply(this,arguments)},n=function(){return(n=Object(c.a)(I().mark(function t(e){var n;return I().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.sendRequest({action:"get",resource:"dataContextList"}).catch(function(t){console.log("unable to get datacontext list because "+t)});case 2:return n=t.sent,t.abrupt("return",n.values.some(function(t){return t.name===e}));case 4:case"end":return t.stop()}},t)}))).apply(this,arguments)},e=function(t){return n.apply(this,arguments)},p=this,d=[],v=(new Date).getFullYear(),y=0,999===this.state.lat||999===this.state.long){t.next=29;break}return t.next=18,r(z);case 18:return t.next=20,u(z.contextName);case 20:return t.next=22,h(z);case 22:return t.next=24,E.sendRequest({action:"create",resource:"dataContext[".concat(z.contextName,"].collection[").concat(z.parentCollectionName,"].case"),values:{values:{location:this.state.loc,latitude:this.state.lat,longitude:this.state.long}}});case 24:return g=t.sent,y=g.values[0].id,m(),t.next=29,E.sendRequest({action:"create",resource:"dataContext[".concat(z.contextName,"].collection[").concat(z.childCollectionName,"].case"),values:d});case 29:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return this.state.hasError?o.a.createElement("h1",null,"Something went wrong!"):o.a.createElement("div",{className:"DayLengthPlugin"},o.a.createElement("h2",null,"How Long Is a Day?"),o.a.createElement("p",null,"Enter a location by typing the name of a city or town and choosing from the list. Or type in a latitude and longitude directly. Press Get Data. The resulting dataset shows a full year\u2019s worth of day length, rise hour and set hour."),o.a.createElement("div",{className:"input"},o.a.createElement("label",null,"Location: ",o.a.createElement("div",{id:"geonameContainer",ref:this.ref})),o.a.createElement("label",null,"Latitude:",o.a.createElement("input",{type:"text",value:this.state.lat,onChange:function(e){return t.setState({lat:e.target.value})},onBlur:function(e){return t.setState({lat:Number(e.target.value)})}})),o.a.createElement("br",null),o.a.createElement("label",null,"Longitude:",o.a.createElement("input",{type:"text",value:this.state.long,onChange:function(e){return t.setState({long:Number(e.target.value)})},onBlur:function(e){return t.setState({long:Number(e.target.value)})}})),o.a.createElement("br",null),o.a.createElement("button",{onClick:this.getData},"Get Data")))}}]),e}(r.Component);i.a.render(o.a.createElement(B,null),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.6a64a68b.chunk.js.map